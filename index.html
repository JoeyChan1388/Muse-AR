<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./index.css" />

    <title>Sphere 1</title>

    <script
      type="module"
      src="https://ajax.googleapis.com/ajax/libs/model-viewer/3.4.0/model-viewer.min.js"
    ></script>
    <!-- Loads <model-viewer> for old browsers like IE11: -->
    <script
      nomodule
      src="https://unpkg.com/@google/model-viewer/dist/model-viewer-legacy.js"
    ></script>
  </head>
  <body>
    <div class="viewer__container">
      <h1> Muse AR </h1>
      <model-viewer
        src="./models/sphere.glb"
        ar
        ar-scale="fixed"
        camera-controls
        touch-action="pan-y"
        shadow-intensity="5"
        skybox-height="2m"
        max-camera-orbit="auto 90deg auto"
        xr-environment
      >
      </model-viewer>

      <div>
        <select id="scene_select">
          <option value="./tiles/den_1.jpg">Den</option>
          <option value="./tiles/kitchen_1.jpg">Kitchen</option>
          <option value="./tiles/entrance_1.jpg">Entrance</option>
        </select>
      </div>
    </div>

    <script>
      const modelViewerTexture1 = document.querySelector("model-viewer");
      const defaultTexture = "./tiles/den_1.jpg";

      modelViewerTexture1.addEventListener("load", () => {
        const material = modelViewerTexture1.model.materials[0];

        const createAndApplyTexture = async (channel, event) => {
          console.log(event.target.value);
          const texture = await modelViewerTexture1.createTexture(
            event.target.value
          );
          console.log(material);

          material["pbrMetallicRoughness"]["baseColorTexture"].setTexture(
            texture
          );
        };

        document
          .querySelector("#scene_select")
          .addEventListener("input", (event) => {
            createAndApplyTexture(
              "pbrmetallicroughness.baseColorTexture",
              event
            );
          });
      });
    </script>
  </body>
</html>
